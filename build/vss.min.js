/*! vss 2014-07-01 */
!function(){function a(){return $&&"localStorage"in window&&null!==window.localStorage?0===r.length||0===t.length?!1:!0:!1}function b(a){return a&&0===a.indexOf(q)?a.substring(q.length,a.length):a}function c(a){return q+b(a)}function d(a){if(a){var b=$(a),c=b[0];if(b.triggerHandler("change"),b.parents(s)){var d=$.Event("change");d.target=c,t.trigger(d)}}}function e(){var a=[];$.each(r.find("input:checked"),function(b,c){a.push(c.id)});var b={};$.each(r.find("input[type=text],textarea"),function(a,c){c.value&&(b[c.id]=c.value)});var c={};$.each(r.find("select"),function(a,b){var d=$(b).find("option:selected").val();d&&(c[b.id]=d)});var d={checkedItems:a,textItems:b,selectedOptionItems:c};return JSON.stringify(d)}function f(a,b){a&&(a=b?a:JSON.parse(a),a&&($.each(r.find("input[type=text],textarea"),function(a,b){$(b).val("")}),$.each(r.find("input:checked"),function(a,b){$(b).prop("checked",!1)}),$.each(r.find("select"),function(a,b){b.selectedIndex=0,d(b)}),$.each(a.textItems,function(a,b){$("#"+a).val(b)}),$.each(a.checkedItems,function(a,b){var c=$("#"+b);c&&(c.prop("checked",!0),d(c))}),$.each(a.selectedOptionItems,function(a,b){var c=$("#"+a);c&&(c.val(b),d(c))}),vsuit.calc()))}function g(){var a=[];return $.map(localStorage,function(c,d){0===d.indexOf(q)&&a.push(b(d))}),a}function h(a){if(a){var b=c(a),d=localStorage.getItem(b);d?f(d):console.log("No saved design found for name: "+a)}}function i(a){return a?(console.log("Saving: "+c(a)),localStorage.setItem(c(a),e()),!0):!1}function j(a){a&&localStorage.removeItem(c(a))}function k(a){var b=$("<select>Load Design</select>").attr("id",a);return b.append($("<option>",{value:"",selected:"selected"}).text("-- Load Saved Design --")),$.each(g(),function(a,c){l(b,c)}),b.change(function(){var a=$(this).find(":selected").val();return a&&(console.log("Loading design: "+a),h(a)),!1}),b}function l(a,b){b&&a.append($("<option>",{value:b}).text(b))}function m(a){var b=$("<button>Delete</button>");return b.click(function(){var b=a.find(":selected").val();return b&&confirm("Are you sure you want to delete: "+b)&&(console.log("Deleting design: "+b),j(b),a.find("option[value="+b+"]").remove()),!1}),b}function n(a){var b=$("<button>Save Current</button>");return b.click(function(){var b=$(a).find(":selected").val(),c=b||(new Date).toLocaleString(),d=prompt("Name this design!",c);return i(d)&&l(a,d),!1}),b}function o(){var a=$("<button>Share</button>");return a.click(function(a){a.preventDefault();var b=e(),c=document.createElement("a");return c.href=document.URL,c.hash=encodeURIComponent(b),prompt("Copy the link below, and share it with your friends. Make sure they're also running VSS.\n\nNOTE: all information entered gets shared, including contact information!",c.href),!1}),a}function p(){var a=window.location.hash.replace(/^#/,"");if(a.length>0){console.log("Detected shared design. Attempting to load...");var b=decodeURIComponent(a),c=JSON.parse(b);c&&f(c,!0)}var d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href","http://localhost:8000/vss.css"),document.body.appendChild(d)}var q="vss-"+$("#item_suitModel :selected").val()+"::",r=$("#content"),s="#panel_options",t=$(s);if(a()){var u=k("vss-designs"),v=m(u),w=n(u),x=o(),y=$('<div id="vss" class="wrapper">').append(u).append(v).append(w).append(x);$(".suit_selector").append(y),p()}else alert("Vertical Suit Saver seems to be out-of-date. Womp womp.")}();